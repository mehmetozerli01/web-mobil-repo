<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Style Storm - Hava Durumu ve Kombin Önerisi</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script defer src="assets/javascript/main.js"></script>
    <script defer src="assets/javascript/clothes.js"></script>
    <!-- TensorFlow.js kütüphanesi -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.11.0/dist/tf.min.js"></script>
    <style>
        .products-section {
            padding: 20px;
            margin-top: 20px;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .product-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.2s;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-image-container {
            width: 100%;
            height: 200px;
            overflow: hidden;
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: white;
        }

        .product-details {
            padding: 15px;
        }

        .product-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .product-meta {
            font-size: 0.8rem;
            color: #888;
        }

        /* Yeni eklenen stiller */
        .clothes-section {
            padding: 40px 0;
            background-color: #f9f9f9;
            margin-top: 40px;
        }

        .section-title {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
            font-size: 2rem;
            font-weight: 600;
        }

        .category-filters {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            padding: 0 20px;
        }

        .filter-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            background-color: #fff;
            color: #333;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-weight: 500;
        }

        .filter-btn:hover {
            background-color: #f0f0f0;
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background-color: #333;
            color: white;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .product-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .product-image-container {
            width: 100%;
            height: 250px;
            overflow: hidden;
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-details {
            padding: 20px;
        }

        .product-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }

        .product-meta {
            font-size: 0.9rem;
            color: #666;
        }

        .product-meta p {
            margin: 5px 0;
        }

        .loading, .no-products {
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: #666;
            background: #f5f5f5;
            border-radius: 8px;
            margin: 20px;
        }

        @media (max-width: 768px) {
            .category-filters {
                padding: 0 10px;
            }
            
            .filter-btn {
                font-size: 0.9rem;
                padding: 8px 16px;
            }

            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 15px;
                padding: 10px;
            }

            .product-image-container {
                height: 200px;
            }
        }

        .clothes-row {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            margin-bottom: 20px;
            justify-content: center;
        }

        .error-container {
            margin: 10px 0;
        }
        .error {
            color: #dc3545;
            padding: 10px;
            border: 1px solid #dc3545;
            border-radius: 4px;
            background-color: #fff0f0;
            margin: 10px 0;
        }

        .category-select-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            margin-bottom: 32px;
        }
        .select-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .select-group label {
            font-size: 1.1rem;
            font-weight: 600;
        }
        .select-group select {
            padding: 8px 16px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 1rem;
        }
        @media (max-width: 600px) {
            .category-select-row {
                flex-direction: column;
                gap: 16px;
            }
        }

        /* Yeni eklenen stiller */
        .image-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .image-container img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .image-container img:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .loading {
            grid-column: 1 / -1;
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: #666;
            background: #f5f5f5;
            border-radius: 8px;
        }

        @media (max-width: 768px) {
            .image-container {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
                padding: 15px;
            }

            .image-container img {
                height: 200px;
            }
        }

        @media (max-width: 480px) {
            .image-container {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 10px;
                padding: 10px;
            }

            .image-container img {
                height: 150px;
            }
        }

        /* Kombin popup stilleri */
        .outfit-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .outfit-popup-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 800px;
            width: 90%;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-popup {
            position: absolute;
            right: 20px;
            top: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .outfit-items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .outfit-item {
            text-align: center;
        }

        .outfit-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .outfit-item span {
            display: block;
            font-size: 0.9rem;
            color: #666;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .error {
            color: #dc3545;
            padding: 15px;
            border: 1px solid #dc3545;
            border-radius: 8px;
            background-color: #fff0f0;
            text-align: center;
        }

        @media (max-width: 600px) {
            .outfit-popup-content {
                width: 95%;
                padding: 20px;
            }

            .outfit-items-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .outfit-item img {
                height: 150px;
            }
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="#" class="navbar-logo">
                <div class="navbar-wheel">
                    <i class="fas fa-sun"></i>
                    <i class="fas fa-cloud-rain"></i>
                    <i class="fas fa-snowflake"></i>
                    <i class="fas fa-tshirt"></i>
                </div>
                Style Storm
            </a>
            <ul class="navbar-links">
                <li><a href="#home">Ana Sayfa</a></li>
                <li><a href="#outfit">Kombin Önerisi</a></li>
                <li><a href="#weather">Hava Durumu</a></li>
                <li><a href="#blog">Blog</a></li>
                <li><a href="#about">Hakkımızda</a></li>
            </ul>
            <div class="auth-buttons">
                <a href="login.html" class="login-btn">Giriş Yap</a>
                <a href="register.html" class="register-btn">Üye Ol</a>
            </div>
        </div>
    </nav>

    <!-- Ana Sayfa İçeriği -->
    <section id="home" class="landing-section">
        <div class="landing-grid">
            <!-- Sol: Hava Durumu Kartı -->
            <div class="landing-weather-card">
                <form id="landingWeatherForm" class="landing-weather-form">
                    <select id="landingCitySelect" class="city-select"></select>
                    <button type="submit" class="fetch-button">Güncelle</button>
                </form>
                <div class="weather-visual">
                    <i class="fas fa-cloud-sun weather-main-icon" id="landingWeatherIcon"></i>
                </div>
                <div class="weather-degree" id="landingTemperature">--°</div>
                <div class="weather-city" id="landingCityName">Şehir</div>
                <div class="weather-desc" id="landingWeatherDescription">Hava durumu</div>
                <div id="landingWeatherError" class="weather-error-message"></div>
            </div>
            <!-- Sağ: Kombin Başlık ve Görsel -->
            <div class="landing-outfit-card">
                <h2 class="landing-title">Bugün Hangi Kombini Seçmeliyim?</h2>
                <button class="landing-outfit-btn">Kombin Önerisi Al</button>
                <div class="landing-outfit-visuals">
                    <img src="assets/images/sapka.jpg" alt="Şapka" class="outfit-visual">
                    <img src="assets/images/sweat.jpg" alt="Sweatshirt" class="outfit-visual">
                    <img src="assets/images/pantolon.webp" alt="Pantolon" class="outfit-visual">
                    <img src="assets/images/ayakkabi.jpeg" alt="Ayakkabı" class="outfit-visual">
                </div>
            </div>
        </div>

        <!-- Kombin Önerisi Popup -->
        <div id="outfitPopup" class="outfit-popup">
            <div class="outfit-popup-content">
                <span class="close-popup">&times;</span>
                <h2>Kombin Önerisi</h2>
                <div class="outfit-items-grid">
                    <div class="outfit-item">
                        <img src="assets/images/sapka.jpg" alt="Şapka">
                        <span>Şapka</span>
                    </div>
                    <div class="outfit-item">
                        <img src="assets/images/sweat.jpg" alt="Sweatshirt">
                        <span>Sweatshirt</span>
                    </div>
                    <div class="outfit-item">
                        <img src="assets/images/pantolon.webp" alt="Pantolon">
                        <span>Pantolon</span>
                    </div>
                    <div class="outfit-item">
                        <img src="assets/images/ayakkabi.jpeg" alt="Ayakkabı">
                        <span>Ayakkabı</span>
                    </div>
                </div>
            </div>
        </div>
        <!-- Alt Sekmeli Menü -->
    </section>

    <!-- Hava Durumu Bölümü (Modern) -->
    <section id="weather" class="weather-section">
        <div class="container">
            <div class="weather-fashion-container">
                <!-- Hava Durumu Kartı -->
                <div class="weather-card">
                    <div class="weather-header">
                        <i class="fas fa-cloud-sun"></i>
                        <h2>Hava Durumu</h2>
                    </div>
                    <div class="weather-content">
                        <form id="weatherForm" class="weather-form">
                            <select id="citySelect" class="city-select" required>
                                <option value="">Şehir Seçin</option>
                            </select>
                            <button type="submit" class="fetch-button">Güncelle</button>
                        </form>
                        <div id="weatherResult">
                            <div class="weather-main">
                                <div class="temperature">
                                    <span class="temp-value">--°</span>
                                    <span class="temp-unit">C</span>
                                </div>
                                <div class="weather-info">
                                    <span class="weather-desc">Hava durumu</span>
                                    <span class="location">Şehir</span>
                                </div>
                            </div>
                            <div class="weather-details">
                                <div class="detail-item">
                                    <i class="fas fa-wind"></i>
                                    <span>-- km/s</span>
                                </div>
                                <div class="detail-item">
                                    <i class="fas fa-tint"></i>
                                    <span>--%</span>
                                </div>
                                <div class="detail-item">
                                    <i class="fas fa-temperature-high"></i>
                                    <span>--°</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Moda İpuçları Kartı -->
                <div class="fashion-card">
                    <div class="fashion-header">
                        <i class="fas fa-tshirt"></i>
                        <h2>Moda İpuçları</h2>
                    </div>
                    <div class="fashion-content">
                        <div class="fashion-image">
                            <img src="assets/images/moda ikonu.png" alt="Moda İkonu">
                        </div>
                        <div class="fashion-tips">
                            <div class="fashion-tip">
                                <i class="fas fa-lightbulb"></i>
                                <p>Klasik bir görünüm için siyah bir elbise ve kırmızı ruj mükemmel bir seçimdir.</p>
                            </div>
                            <div class="fashion-tip">
                                <i class="fas fa-gem"></i>
                                <p>Kıyafetinize şıklık katmak için minimalist takılar tercih edin.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Kıyafetler Bölümü -->
    <section id="clothes" class="clothes-section">
        <div class="container">
            <h2 class="section-title" style="text-align:center; margin-bottom:32px;">Kıyafet Görselleri</h2>
            <div class="category-select-row" style="display:flex;justify-content:center;gap:40px;margin-bottom:32px;">
                <div class="select-group" style="display:flex;align-items:center;gap:10px;">
                    <label for="mainCategory">Ana Kategori:</label>
                    <select id="mainCategory">
                        <option value="">Seçin</option>
                    </select>
                </div>
                <div class="select-group" style="display:flex;align-items:center;gap:10px;">
                    <label for="subCategory">Alt Kategori:</label>
                    <select id="subCategory">
                        <option value="">Seçin</option>
                    </select>
                </div>
            </div>
            <div id="errorContainer"></div>
            <div class="image-container" id="imageContainer"></div>
        </div>
    </section>

    <!-- Yazlık ve Kışlık Kıyafetler Bölümü -->
    <section id="random-clothes" style="padding:40px 0;">
        <h2 style="text-align:center;">☀ Yazlık Kıyafetler</h2>
        <div id="yazlik-images" class="clothes-row"></div>
        <h2 style="text-align:center;margin-top:40px;">❄ Kışlık Kıyafetler</h2>
        <div id="kislik-images" class="clothes-row"></div>
    </section>

    <!-- Kombin Önerisi Bölümü -->
    <section id="outfit" class="outfit-section">
        <div class="container">
            <div class="outfit-cards-container" id="dynamicOutfitCards"></div>
        </div>
    </section>

    <!-- Blog Bölümü -->
    <section id="blog" class="blog-section">
        <div class="container">
            <h2>Moda İpuçları ve Öneriler</h2>
            <div class="blog-slider">
                <button class="slider-btn prev-btn">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="slider-container">
                    <div class="slider-track">
                        <!-- Slides will be added dynamically via JavaScript -->
                    </div>
                </div>
                <button class="slider-btn next-btn">
                    <i class="fas fa-chevron-right"></i>
                </button>
                <div class="slider-dots">
                    <!-- Dots will be added dynamically via JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- Hakkımızda Bölümü -->
    <section id="about" class="about-section">
        <div class="container">
            <div class="about-content">
                <h2>Hakkımızda</h2>
                <div class="about-text">
                    <p>Style Storm, hava durumu verilerini kullanarak günlük hayatınız için en uygun kombinleri öneren yenilikçi bir platformdur. Amacımız, kullanıcılarımızın her gün, havanın nasıl olacağına göre şık ve rahat kombinler oluşturmasına yardımcı olmaktır. Yapay zeka destekli algoritmamız, mevcut hava durumu verilerini analiz ederek, kullanıcılara sadece pratik değil, aynı zamanda moda anlayışına hitap eden giyim önerileri sunar.</p>
                    
                    <p>Platformumuzda, hava durumunun ötesinde, kullanıcıların ruh haline ve kişisel tercihlerine göre de kombin önerileri alabilmeleri mümkündür. Günün hava koşullarını ve sizin stil tercihleriniz doğrultusunda, şıklığı ve rahatlığı bir araya getiren en uygun kıyafetleri seçmek hiç bu kadar kolay olmamıştı!</p>
                    
                    <p>Style Storm olarak, kullanıcı deneyimini her zaman ön planda tutuyor ve sürekli gelişen yapay zeka teknolojilerini kullanarak, giyim tarzınıza yön verecek öneriler sunmayı amaçlıyoruz. Bize katılın, her gün şık ve rahat kombinlerle stilinizi keşfedin!</p>
                </div>

                <div class="mission-section">
                    <h3>Misyonumuz</h3>
                    <div class="mission-text">
                        <p>Style Storm olarak misyonumuz, kullanıcılarımıza günlük yaşamda stil sahibi ve rahat kombinler sunarak, hava durumu ve kişisel tercihlerine dayalı olarak en uygun giyim seçeneklerini sağlamak ve her an şıklığı kolaylaştırmaktır. Yapay zeka destekli önerilerimizle, kullanıcılarımızın moda dünyasında daha bilinçli seçimler yapmalarını ve her gün kendilerini rahat hissedecekleri şekilde giyinmelerini sağlıyoruz.</p>
                        
                        <p>Gelişen teknoloji ve modayı bir araya getirerek, her kullanıcıya özelleştirilmiş ve kişiselleştirilmiş kombin önerileri sunmayı hedefliyoruz. Böylece, her kullanıcımızın tarzını keşfetmesini ve stilini en verimli şekilde yansıtmasını sağlıyoruz.</p>
                    </div>
                </div>

                <div class="vision-section">
                    <h3>Vizyonumuz</h3>
                    <div class="vision-text">
                        <p>Style Storm olarak vizyonumuz, yapay zeka ve hava durumu verilerini en verimli şekilde entegre ederek, moda dünyasında devrim yaratmak ve kullanıcılarımıza daha önce hiç deneyimlemedikleri bir kombin öneri platformu sunmaktır. Gelecekte, sadece hava durumu değil, kullanıcıların tüm yaşam biçimlerine uyum sağlayan, daha dinamik ve entegre bir giyim öneri sistemi geliştirmeyi amaçlıyoruz.</p>
                        
                        <p>Yapay zeka teknolojisinin gücünü kullanarak, her kullanıcının stilini en üst düzeye çıkaracak, onların kendilerini özgür ve şık hissettikleri bir dünya yaratmayı hedefliyoruz. Global çapta tanınan, kullanıcı odaklı, yenilikçi ve trend belirleyici bir moda platformu olmak istiyoruz.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Moda İpuçları Bölümü -->
    <section class="fashion-tips-section">
        <div class="container">
            <h2 class="section-title">Moda İpuçları</h2>
            <div class="fashion-tips-slider">
                <button class="slider-btn prev-btn">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="slider-container">
                    <div class="slider-track">
                        <!-- Slides will be added dynamically via JavaScript -->
                    </div>
                </div>
                <button class="slider-btn next-btn">
                    <i class="fas fa-chevron-right"></i>
                </button>
                <div class="slider-dots">
                    <span class="slider-dot active"></span>
                    <span class="slider-dot"></span>
                    <span class="slider-dot"></span>
                    <span class="slider-dot"></span>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Style Storm</h3>
                <p>Hava durumuna göre kombin önerileri sunan moda platformu.</p>
            </div>
            <div class="footer-section">
                <h3>Hızlı Bağlantılar</h3>
                <ul>
                    <li><a href="#home">Ana Sayfa</a></li>
                    <li><a href="#outfit">Kombin Önerisi</a></li>
                    <li><a href="#weather">Hava Durumu</a></li>
                    <li><a href="#blog">Blog</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>İletişim</h3>
                <p>Email: info@stylestorm.com</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Style Storm | Tüm hakları saklıdır.</p>
        </div>
    </footer>

    <!-- Giriş/Kayıt Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="auth-tabs">
                <button class="tab-btn active" data-tab="login">Giriş Yap</button>
                <button class="tab-btn" data-tab="register">Üye Ol</button>
            </div>
            <div class="tab-content">
                <form id="loginForm" class="auth-form">
                    <input type="email" placeholder="E-posta" required>
                    <input type="password" placeholder="Şifre" required>
                    <button type="submit">Giriş Yap</button>
                </form>
                <form id="registerForm" class="auth-form hidden">
                    <input type="text" placeholder="Ad Soyad" required>
                    <input type="email" placeholder="E-posta" required>
                    <input type="password" placeholder="Şifre" required>
                    <input type="password" placeholder="Şifre Tekrar" required>
                    <button type="submit">Üye Ol</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Gerekli JavaScript -->
    <script defer src="assets/javascript/main.js"></script>
    <script defer src="assets/javascript/random_clothes.js"></script>
    <script>
    const apiBase = "http://127.0.0.1:8000";
    const errorContainer = document.getElementById("errorContainer");

    // Kombin önerisi için gerekli kategoriler
    const outfitCategories = ['ust_giyim', 'alt_giyim', 'ayakkabi', 'aksesuar'];

    // Popup elementlerini seç
    const outfitPopup = document.getElementById('outfitPopup');
    const closePopup = document.querySelector('.close-popup');
    const outfitItemsGrid = document.querySelector('.outfit-items-grid');

    // Popup'ı aç/kapat fonksiyonları
    function openOutfitPopup() {
        outfitPopup.style.display = 'flex';
        loadRandomOutfit();
    }

    function closeOutfitPopup() {
        outfitPopup.style.display = 'none';
    }

    // Kombin önerisi için ana kategorileri API'dan dinamik olarak çek
    async function loadRandomOutfit() {
        try {
            outfitItemsGrid.innerHTML = '<div class="loading">Kombin yükleniyor...</div>';
            // Ana kategorileri çek
            const mainCatRes = await fetch(`${apiBase}/categories`);
            if (!mainCatRes.ok) throw new Error('Ana kategoriler alınamadı.');
            const mainCategories = await mainCatRes.json();
            
            // Her ana kategori için random alt kategori ve random görsel seç
            const outfitPromises = mainCategories.map(async (category) => {
                // Alt kategorileri çek
                const subCatRes = await fetch(`${apiBase}/categories/${category}`);
                if (!subCatRes.ok) return null;
                const subCategories = await subCatRes.json();
                if (!subCategories.length) return null;
                // Random alt kategori seç
                const randomSub = subCategories[Math.floor(Math.random() * subCategories.length)];
                // Görselleri çek
                const imgRes = await fetch(`${apiBase}/categories/${category}/${randomSub}`);
                if (!imgRes.ok) return null;
                const images = await imgRes.json();
                if (!images.length) return null;
                // Random görsel seç
                const randomImg = images[Math.floor(Math.random() * images.length)];
                return {
                    category,
                    subCategory: randomSub,
                    imageUrl: apiBase + randomImg
                };
            });
            const outfitItems = (await Promise.all(outfitPromises)).filter(Boolean);
            if (!outfitItems.length) {
                outfitItemsGrid.innerHTML = '<div class="error">Kombin oluşturulamadı. Kategorilerde uygun görsel bulunamadı.</div>';
                return;
            }
            // Popup içeriğini güncelle
            outfitItemsGrid.innerHTML = outfitItems.map(item => `
                <div class="outfit-item">
                    <img src="${item.imageUrl}" alt="${item.subCategory}" onerror="this.src='https://via.placeholder.com/200x200?text=Görsel+Yok'">
                    <span>${item.subCategory}</span>
                </div>
            `).join('');
        } catch (error) {
            outfitItemsGrid.innerHTML = `<div class="error">Kombin oluşturulamadı. ${error.message}</div>`;
        }
    }

    // Event listener'ları ekle
    document.querySelector('.landing-outfit-btn').addEventListener('click', openOutfitPopup);
    closePopup.addEventListener('click', closeOutfitPopup);
    window.addEventListener('click', (e) => {
        if (e.target === outfitPopup) {
            closeOutfitPopup();
        }
    });

    function showError(message) {
        errorContainer.innerHTML = `<div style='color:#c00;background:#ffeaea;border:1px solid #c00;border-radius:6px;padding:12px;margin:24px 0;text-align:center;'>${message}</div>`;
    }
    function clearError() {
        errorContainer.innerHTML = '';
    }

    async function loadMainCategories() {
        try {
            clearError();
            const res = await fetch(`${apiBase}/categories`);
            if (!res.ok) throw new Error("Ana kategoriler yüklenemedi.");
            const categories = await res.json();
            const mainCategorySelect = document.getElementById("mainCategory");
            mainCategorySelect.innerHTML = '<option value="">Seçin</option>';
            categories.forEach(cat => {
                const option = document.createElement("option");
                option.value = cat;
                option.textContent = cat;
                mainCategorySelect.appendChild(option);
            });
        } catch (e) {
            showError(e.message);
        }
    }

    async function loadSubcategories() {
        try {
            clearError();
            const mainCategory = document.getElementById("mainCategory").value;
            const subCategorySelect = document.getElementById("subCategory");
            subCategorySelect.innerHTML = '<option value="">Seçin</option>';
            document.getElementById("imageContainer").innerHTML = '';
            if (!mainCategory) return;
            const res = await fetch(`${apiBase}/categories/${mainCategory}`);
            if (!res.ok) throw new Error("Alt kategoriler yüklenemedi.");
            const subcategories = await res.json();
            subcategories.forEach(sub => {
                const option = document.createElement("option");
                option.value = sub;
                option.textContent = sub;
                subCategorySelect.appendChild(option);
            });
        } catch (e) {
            showError(e.message);
        }
    }

    async function loadImages() {
        try {
            clearError();
            const mainCategory = document.getElementById("mainCategory").value;
            const subCategory = document.getElementById("subCategory").value;
            const imageContainer = document.getElementById("imageContainer");
            imageContainer.innerHTML = '';
            if (!mainCategory || !subCategory) return;
            imageContainer.innerHTML = '<div class="loading">Görseller yükleniyor...</div>';
            const res = await fetch(`${apiBase}/categories/${mainCategory}/${subCategory}`);
            if (!res.ok) throw new Error("Görseller yüklenemedi.");
            const images = await res.json();
            if (!images.length) {
                imageContainer.innerHTML = '<div style="text-align:center;margin:32px 0;font-size:1.1rem;color:#666;">Bu kategoride görsel bulunamadı.</div>';
                return;
            }
            imageContainer.innerHTML = '';
            images.forEach(imgUrl => {
                const img = document.createElement("img");
                img.src = apiBase + imgUrl;
                img.alt = `${mainCategory} - ${subCategory}`;
                img.onerror = () => {
                    img.src = 'https://via.placeholder.com/200x200?text=Görsel+Yok';
                };
                imageContainer.appendChild(img);
            });
        } catch (e) {
            showError(e.message);
            document.getElementById("imageContainer").innerHTML = '';
        }
    }

    document.getElementById("mainCategory").addEventListener("change", loadSubcategories);
    document.getElementById("subCategory").addEventListener("change", loadImages);
    window.addEventListener("DOMContentLoaded", loadMainCategories);

    // Dinamik kombin kartları oluşturma
    const kombinTypes = [
        { title: 'Günlük Kombin', icon: 'fa-tshirt' },
        { title: 'Resmi Kombin', icon: 'fa-user-tie' },
        { title: 'Spor Kombin', icon: 'fa-running' }
    ];

    async function getRandomKombinForCard() {
        // Ana kategorileri çek
        const mainCatRes = await fetch(`${apiBase}/categories`);
        if (!mainCatRes.ok) return [];
        const mainCategories = await mainCatRes.json();
        // Her ana kategori için random alt kategori ve random görsel seç
        const outfitPromises = mainCategories.map(async (category) => {
            const subCatRes = await fetch(`${apiBase}/categories/${category}`);
            if (!subCatRes.ok) return null;
            const subCategories = await subCatRes.json();
            if (!subCategories.length) return null;
            const randomSub = subCategories[Math.floor(Math.random() * subCategories.length)];
            const imgRes = await fetch(`${apiBase}/categories/${category}/${randomSub}`);
            if (!imgRes.ok) return null;
            const images = await imgRes.json();
            if (!images.length) return null;
            const randomImg = images[Math.floor(Math.random() * images.length)];
            return {
                category,
                subCategory: randomSub,
                imageUrl: apiBase + randomImg
            };
        });
        return (await Promise.all(outfitPromises)).filter(Boolean);
    }

    async function renderDynamicKombinCards() {
        const container = document.getElementById('dynamicOutfitCards');
        container.innerHTML = '<div class="loading">Kombinler yükleniyor...</div>';
        try {
            // Her kart için ayrı random kombin oluştur
            const allKombins = await Promise.all([
                getRandomKombinForCard(),
                getRandomKombinForCard(),
                getRandomKombinForCard()
            ]);
            container.innerHTML = '';
            kombinTypes.forEach((type, idx) => {
                const kombin = allKombins[idx];
                if (!kombin.length) {
                    container.innerHTML += `<div class="outfit-card"><div class="outfit-header"><i class="fas ${type.icon}"></i><h2>${type.title}</h2></div><div class="outfit-content"><div class="error">Kombin bulunamadı.</div></div></div>`;
                    return;
                }
                container.innerHTML += `
                <div class="outfit-card">
                    <div class="outfit-header">
                        <i class="fas ${type.icon}"></i>
                        <h2>${type.title}</h2>
                    </div>
                    <div class="outfit-content">
                        <div class="outfit-items">
                            ${kombin.map(item => `
                                <div class="outfit-item">
                                    <img src="${item.imageUrl}" alt="${item.subCategory}" class="outfit-image" onerror="this.src='https://via.placeholder.com/200x200?text=Görsel+Yok'">
                                    <span>${item.subCategory}</span>
                                </div>
                            `).join('')}
                        </div>
                        <button class="outfit-btn">Bu Kombini Seç</button>
                    </div>
                </div>
                `;
            });
        } catch (e) {
            container.innerHTML = `<div class="error">Kombinler yüklenirken hata oluştu.</div>`;
        }
    }
    // Sayfa yüklendiğinde kombin kartlarını getir
    window.addEventListener('DOMContentLoaded', renderDynamicKombinCards);
    </script>
</body>

</html>
